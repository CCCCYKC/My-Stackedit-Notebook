# VUE3 进阶知识

## 1. `props` 声明
>所有的 props 都遵循着**单向绑定**原则，props 因父组件的更新而变化，自然地将新的状态向下流往子组件，而不会逆向传递
>props 是只读的
- 声明方法可以用数组、对象
- 声明 `props` 还可以对其设置**默认值、类型检验、是否必填**
```html
<script setup>
const props = defineProps({  // 或 const props = defineProps(['foo'])
	title: {
		type: String,
		required: true
	},  
	likes: {
		type: [Number, null],
		default: 100
	}  
})
console.log(props.title, props.likes)
</script>
```
- 若要监听传递进来的 `props`，只能将其包装在 `getter` 中来侦听解构的 `prop`
```js
const { foo } = defineProps(['foo'])
watch(() => foo, /* ... */)
```

## 2. 事件 `$emit`
- `$emit` 可传递两个参数，为 `$emit('事件名称', 参数)`，参数会成为父组件触发事件的参数
- 若有多个参数，则用大括号包裹 `$emit('事件名称', { 参数1, 参数2 })`
- 同时，在子组件中要通过 `defineEmits()` 宏来声明它要触发的事件
```html
// 子组件
<script setup>
defineEmits(['increaseBy'])
</script>
<button @click="$emit('increaseBy', 1)">
  Increase by 1
</button>

// 父组件
<script>
function increaseCount(n) {
  count.value += n
}
</script>
<MyButton @increase-by="increaseCount" />
```
- **补充：** 还可以对事件和其参数进行检验
```html
<script setup>
const emit = defineEmits({
  // click 事件没有校验
  click: null,
  // 校验 submit 事件
  submit: ({ email, password }) => {
    if (email && password) {
      return true
    } else {
      console.warn('Invalid submit event payload!')
      return false
    }
  }
})
function submitForm(email, password) {
  emit('submit', { email, password })
}
</script>
```

## 3. `v-model`
- vue3 中，使用 `v-model` 时要先定义 `defineModel` 
- `defineModel` 返回的是一个 `ref`，它可以像其他 ref 一样被访问以及修改，不过它能起到在父组件和当前变量之间的双向绑定的作用
- 还可以设定默认值、是否必填
```html
<script setup>
const model = defineModel()
// 使 v-model 必填
//const model = defineModel({ required: true })
// 提供一个默认值 (父子组件传递中不推荐, 会使得传递的 props 的值不同)
//const model = defineModel({ default: 0 })
</script>

<template>
  <input v-model="model" />
</template>
```
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTk4MjA3ODk0OSwxNzA3Nzc5MjUxXX0=
-->